{"data":{"github":{"repository":{"object":{"__typename":"GitHub_Blob","text":"; Extend the polynomial system to include subtraction of polynomials. (Hint: You may\n; find it helpful to define a generic negation operation.)\n\n(load \"packages/general.scm\")\n\n; Add the following genric negation operations\n; (i) scheme-numer\n(put 'negate '(scheme-number) (lambda (x) (tag (- x))))\n\n; (ii) rational\n(put 'negate '(rational) \n    (lambda (r) (make-rat (- numer r) (denom r))))\n\n; (iii) complex\n(put 'negate '(complex)\n    (lambda (z) (make-from-real-imag \n                    (- (real-part z))\n                    (- (imag-part z)))))\n\n; (iv) Polynomial package\n(define (negate-terms term-list)\n    (if (empty-termlist? term-list)\n        the-empty-termlist\n        (adjoin-term\n            (make-term \n                (order (first-term term-list)) \n                (negate (coeff (first-term term-list))))\n            (negate-terms (rest-terms term-list)))))\n(define (sub-poly p1 p2)\n    (if (same-variable? (variable p1) (variable p2))\n        (make-poly \n            (variable p1)\n            (add-terms (term-list p1) (negate-terms (term-list p2))))\n        (error \"Polys not in same var: SUB-POLY\" (list p1 p2))))\n(put 'negate '(polynomial)\n    (lambda (p) \n        (make-polynomial \n            (variable p)\n            (negate-terms (term-list p)))))\n(put 'sub '(polynomial polynomial)\n    (lambda (p1 p2) (tag (sub-poly p1 p2))))\n\n(load \"packages/polynomial.scm\")\n(load \"arithmetic-package.scm\")\n\n(install-polynomial-package)\n\n; Testing\n(define p1 \n    (make-polynomial \n        'x\n        (list (make-term  2  (make-scheme-number 2))\n              (make-term  1  (make-scheme-number 5))\n              (make-term  0  (make-scheme-number 3))))) ; 2x^2 + 5x + 3\n\n(define p2 \n    (make-polynomial \n        'x\n        (list (make-term  3  (make-scheme-number 1))\n              (make-term  1  (make-scheme-number 4))\n              (make-term  0  (make-scheme-number 2))))) ; x^3 + 4x + 2\n\n(sub p2 p1)\n; (polynomial x \n;    (3 (scheme-number . 1)) \n;    (2 (scheme-number . -2))\n;    (1 (scheme-number . -1))\n;    (0 (scheme-number . -1)) -> x^3 - 2x^2 - c - 1"}}}},"pageContext":{"name":"2.88.scm","expr":"master:sicp/ch2-abstraction-data/2.88.scm"}}