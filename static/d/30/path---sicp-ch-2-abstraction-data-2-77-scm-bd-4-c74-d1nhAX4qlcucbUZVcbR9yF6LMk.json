{"data":{"github":{"repository":{"object":{"__typename":"GitHub_Blob","text":"; Louis Reasoner tries to evaluate the expression (magnitude z) where z is the \n; object shown in Figure 2.24. To his surprise, instead of the answer 5 he gets \n; an error message from `apply-generic`, saying there is no method for the operation\n; magnitude on the types (complex). He shows this interaction to Alyssa P. Hacker, \n; who says “The problem is that the complex-number selectors were never defined for \n; complex numbers, just for polar and rectangular numbers. All you have to do to make\n; this work is add the following to the complex package:”\n; ```\n; (put 'real-part '(complex) real-part)\n; (put 'imag-part '(complex) imag-part)\n; (put 'magnitude '(complex) magnitude)\n; (put 'angle '(complex) angle)\n; ```\n; Describe in detail why this works. As an example, trace through all the procedures \n; called in evaluating the expression `(magnitude z)` where `z` is the object shown in \n; Figure 2.24. In particular, how many times is `apply-generic` invoked? What procedure\n; is dispatched to in each case?\n\n; Testing\n(load \"arithmetic-package.scm\")\n\n(put 'real-part '(complex) real-part)\n(put 'imag-part '(complex) imag-part)\n(put 'magnitude '(complex) magnitude)\n(put 'angle '(complex) angle)\n\n(define z (make-complex-from-real-imag 3 4))\n(magnitude z) ;Value: 5\n\n; Answer\n; ---------------\n; We cannot interact with methods not defined as interface in the \"arithmetic-package\"\n; Hence, adding the above lines makes it accessible for complex type\n\n; (make-complex-from-real-imag 3 4)\n; => (complex rectangular 3 4)\n; \n; (magnitude z)\n; => (magnitude '(complex rectangular 3 4))\n; => (apply-generic 'magnitude '(complex rectangular 3 4))\n; => (apply magnitude '(rectangular 3 4))\n; => (magnitude '(rectangular 3 4))\n; => (apply-generic 'magnitude '(rectangular 3 4))\n; => (apply (lambda (z) (sqrt (+ (square (real-part z)) (square (imag-part z)))))\n;           '(3 4))\n; => 5\n\n; `apply-generic` is calle twice"}}}},"pageContext":{"name":"2.77.scm","expr":"master:sicp/ch2-abstraction-data/2.77.scm"}}