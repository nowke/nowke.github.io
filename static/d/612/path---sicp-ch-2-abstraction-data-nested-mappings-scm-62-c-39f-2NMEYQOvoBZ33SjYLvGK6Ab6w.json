{"data":{"github":{"repository":{"object":{"__typename":"GitHub_Blob","text":"(define nil '())\n(define (enumarate-interval low high)\n    (if (> low high)\n        nil\n        (cons low (enumarate-interval (+ low 1) high))))\n(define (accumulate op initial sequence)\n    (if (null? sequence) \n        initial\n        (op (car sequence) (accumulate op initial (cdr sequence)))))\n(define (divides? a b) (= (remainder b a) 0))\n(define (prime? n)\n    (define (smallest-divisor n) (find-divisor n 2))\n    (define (find-divisor n test-divisor)\n        (cond ((> (square test-divisor) n) n)\n                ((divides? test-divisor n) test-divisor)\n                (else (find-divisor n (+ test-divisor 1)))))\n    (= n (smallest-divisor n)))\n\n; Problem: Given positive integer n, find all ordered pairs of distinctive\n; integers i, j, where 1 <= j < i <= n, such that i+j is prime\n(define (flatmap proc seq)\n    (accumulate append nil (map proc seq)))\n(define (prime-sum? pair)\n    (prime? (+ (car pair) (cadr pair))))\n(define (make-pair-sum pair)\n    (list (car pair) (cadr pair) (+ (car pair) (cadr pair))))\n\n(define (prime-sum-pairs n)\n    (map make-pair-sum\n         (filter \n            prime-sum?\n            (flatmap\n                (lambda (i)\n                  (map (lambda (j) (list i j))\n                       (enumarate-interval 1 (- i 1))))\n                (enumarate-interval 1 n)))))\n\n(prime-sum-pairs 6)\n; ((2 1 3) (3 2 5) (4 1 5) (4 3 7) (5 2 7) (6 1 7) (6 5 11))\n\n; Problem: Permutations of a set\n(define (permutations s)\n    (if (null? s)\n        (list nil)\n        (flatmap \n            (lambda (x)\n                (map (lambda (p) (cons x p))\n                     (permutations (remove x s))))\n            s)))\n(define (remove item sequence)\n    (filter (lambda (x) (not (= x item)))\n            sequence))\n\n(permutations (list 1 2 3))\n;Value 3: ((1 2 3) (1 3 2) (2 1 3) (2 3 1) (3 1 2) (3 2 1))\n\n"}}}},"pageContext":{"name":"nested-mappings.scm","expr":"master:sicp/ch2-abstraction-data/nested-mappings.scm"}}